<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="这些文章没啥用"><title>Phoenix Secondary Index初探之Global Index | dequn's blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-105163669-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Phoenix Secondary Index初探之Global Index</h1><a id="logo" href="/.">dequn's blog</a><p class="description">这些文章没啥用</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Phoenix Secondary Index初探之Global Index</h1><div class="post-meta">Aug 29, 2016<span> | </span><span class="category"><a href="/categories/Phoenix/">Phoenix</a></span></div><a data-disqus-identifier="2016/08/29/Phoenix-Secondary-Index-Exploration-Global-Index/" href="/2016/08/29/Phoenix-Secondary-Index-Exploration-Global-Index/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>上篇我们提到了HBase建立二级索引的原理，但是当我们自己建立二级索引，就需要做额外很多工作，我们需要定义Coprocessor，在数据更新的时候更新索引，查询时先去检索索引表等，定义这些Coprocessor不仅费时费力，而且一般使用者不能保证程序的高效性、健壮性等。还好，已经有不少构建在HBase上的插件——个人觉得称之为插件更为合理，已经帮我们做了这些工作，Phoenix就是其中一种。</p>
<p>Phoenix提供的二级索引按索引对象可以分为Covered Indexes 和 Functional Indexes，Covered Indexed就是对原始数据进行所以，Functional Indexes就是就原始数据进行处理后再索引，区别从<a href="https://phoenix.apache.org/secondary_indexing.html" target="_blank" rel="noopener">官方给出的两个例子</a>就可以很明显的看出，不再讨论。</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Covered Indexes</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> my_index <span class="keyword">ON</span> my_table (v1,v2) <span class="keyword">INCLUDE</span>(v3)</span><br><span class="line"></span><br><span class="line"># Functional Indexes</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> UPPER_NAME_IDX <span class="keyword">ON</span> EMP (<span class="built_in">UPPER</span>(FIRST_NAME||<span class="string">' '</span>||LAST_NAME))</span><br><span class="line"><span class="keyword">SELECT</span> EMP_ID <span class="keyword">FROM</span> EMP <span class="keyword">WHERE</span> <span class="built_in">UPPER</span>(FIRST_NAME||<span class="string">' '</span>||LAST_NAME)=<span class="string">'JOHN DOE'</span></span><br></pre></td></tr></table></figure>
<p>另外Phoenix的索引分为<strong>Global Indexes</strong> 和 <strong>Local Indexes</strong>,官方文档提到，Global Index适合适用于<strong>读多写少</strong>的场景，Local Index适合<strong>频繁写</strong>的场景，那么这两种索引到底有什么区别呢？</p>
<h1 id="1-建立数据表，明确需求"><a href="#1-建立数据表，明确需求" class="headerlink" title="1 建立数据表，明确需求"></a>1 建立数据表，明确需求</h1><p>因为是课题需要，已经存在一张数据表<code>BIGJOY.IMOS</code>，大概有400万行的数据，最初就是使用Phoenix建立的，给大家看一下该表的结构，注意该cell不是HBase的Cell，不要混淆。</p>
<table>
<thead>
<tr>
<th>COLUMN_NAME</th>
<th>DATA_TYPE</th>
<th>TYPE_NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>1</td>
<td>CHAR</td>
</tr>
<tr>
<td>FLOOR</td>
<td>1</td>
<td>CHAR</td>
</tr>
<tr>
<td>TIME</td>
<td>93</td>
<td>TIMESTAMP</td>
</tr>
<tr>
<td>MAC</td>
<td>1</td>
<td>CHAR</td>
</tr>
<tr>
<td>X</td>
<td>4</td>
<td>INTEGER</td>
</tr>
<tr>
<td>Y</td>
<td>4</td>
<td>INTEGER</td>
</tr>
<tr>
<td>CELL</td>
<td>1</td>
<td>CHAR</td>
</tr>
</tbody>
</table>
<p><strong>需求:</strong>1.根据mac和time约束查询cell;2.根据cell和time约束查询mac。以需求1为例，探索Phoenix Secondary Index的工作原理。</p>
<h1 id="2-对比案例"><a href="#2-对比案例" class="headerlink" title="2 对比案例"></a>2 对比案例</h1><p>为了方便和严谨，本文建立索引前后进行了下面的八个查询，也是从这八个查询探究Phoenix Secondary Index，下面就先列出这8个查询语句。</p>
<table>
<thead>
<tr>
<th>编号</th>
<th>SQl</th>
<th>查询结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>select cell from bigjoy.imos where mac = &#39;28E14CA61635&#39;;</code></td>
<td>28条记录</td>
</tr>
<tr>
<td>2</td>
<td><code>select time from bigjoy.imos where mac = &#39;28E14CA61635&#39;;</code></td>
<td>28条记录</td>
</tr>
<tr>
<td>3</td>
<td><code>select floor from bigjoy.imos where mac = &#39;28E14CA61635&#39;;</code></td>
<td>28条记录</td>
</tr>
<tr>
<td>4</td>
<td><code>select * from bigjoy.imos where mac = &#39;28E14CA61635&#39;;</code></td>
<td>28条记录</td>
</tr>
<tr>
<td>5</td>
<td><code>select mac from bigjoy.imos where time = to_date(&#39;2014-04-01 20:39:42.000&#39;);</code></td>
<td>223条记录</td>
</tr>
<tr>
<td>6</td>
<td><code>select cell from bigjoy.imos where time = to_date(&#39;2014-04-01 20:39:42.000&#39;);</code></td>
<td>223条记录</td>
</tr>
<tr>
<td>7</td>
<td><code>select cell from bigjoy.imos where mac = &#39;28E14CA61635&#39; and time = to_date(&#39;2014-04-01 20:39:42.000&#39;);</code></td>
<td>1条记录</td>
</tr>
<tr>
<td>8</td>
<td><code>select * from bigjoy.imos where mac = &#39;28E14CA61635&#39; and time = to_date(&#39;2014-04-01 20:39:42.000&#39;);</code></td>
<td>1条记录</td>
</tr>
</tbody>
</table>
<h1 id="3-建立mac-time全局索引"><a href="#3-建立mac-time全局索引" class="headerlink" title="3 建立mac-time全局索引"></a>3 建立mac-time全局索引</h1><p>下面建立针对mac的索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> bigjoy.mac_idx <span class="keyword">on</span> bigjoy.imos (mac,<span class="keyword">time</span>) <span class="keyword">include</span> (cell)</span><br><span class="line"># <span class="keyword">global</span> <span class="keyword">index</span> default.</span><br></pre></td></tr></table></figure>
<h1 id="4-效率对比"><a href="#4-效率对比" class="headerlink" title="4 效率对比"></a>4 效率对比</h1><p>针对2中的8条SQL，再次进行查询，与建立索引前的对比如下表:</p>
<table>
<thead>
<tr>
<th>编号</th>
<th>建立索引前(秒)</th>
<th>建立索引后(秒)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>7.236</td>
<td>0.175</td>
</tr>
<tr>
<td>2</td>
<td>6.553</td>
<td>0.029</td>
</tr>
<tr>
<td>3</td>
<td>7.581</td>
<td>6.826</td>
</tr>
<tr>
<td>4</td>
<td>7.171</td>
<td>6.616</td>
</tr>
<tr>
<td>5</td>
<td>7.129</td>
<td>9.926</td>
</tr>
<tr>
<td>6</td>
<td>7.258</td>
<td>7.039</td>
</tr>
<tr>
<td>7</td>
<td>7.632</td>
<td>0.026</td>
</tr>
<tr>
<td>8</td>
<td>7.682</td>
<td>7.383</td>
</tr>
</tbody>
</table>
<p>可以看出，建立索引是选择的是(mac,time)字段,并且包含了cell字段，以mac为约束查询time或cell字段效率提升很大，但当查询floor字段或者包含其他字段的时候，索引的存在并没有提升效率，以time为约束的查询在索引建立前后也没有效率上的改变。</p>
<p>下面就深入分析一下原因。</p>
<h2 id="4-1-查看一下数据表有木有变化"><a href="#4-1-查看一下数据表有木有变化" class="headerlink" title="4.1 查看一下数据表有木有变化"></a>4.1 查看一下数据表有木有变化</h2><p>索引建立好后，先使用Phoenix的 <code>!tables</code> 命令查看一下所用的数据表，从结果中可以看出多出了一个<strong>BIGJOY.MAC_IDX</strong>的数据表，如图所示。</p>
<p><img src="http://obqjd695a.bkt.clouddn.com/phoenix%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95%E5%90%8E%E5%A4%9A%E5%87%BA%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E8%A1%A8.PNG" alt="使用Phoenix建立索引后多出一个数据表"></p>
<h2 id="4-2-探索索引表的结构"><a href="#4-2-探索索引表的结构" class="headerlink" title="4.2 探索索引表的结构"></a>4.2 探索索引表的结构</h2><p>首先看一下该表都有哪些字段呀！</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:phoenix:localhost&gt; !describe bigjoy.mac_idx</span><br><span class="line">+------------+--------------+-------------+--------------+------------+------------+--------------+----------------+-----------------+-----------------+-----+</span><br><span class="line">|<span class="string"> TABLE_CAT  </span>|<span class="string"> TABLE_SCHEM  </span>|<span class="string"> TABLE_NAME  </span>|<span class="string"> COLUMN_NAME  </span>|<span class="string"> DATA_TYPE  </span>|<span class="string"> TYPE_NAME  </span>|<span class="string"> COLUMN_SIZE  </span>|<span class="string"> BUFFER_LENGTH  </span>|<span class="string"> DECIMAL_DIGITS  </span>|<span class="string"> NUM_PREC_RADIX  </span>|<span class="string"> NUL </span>|</span><br><span class="line">+------------+--------------+-------------+--------------+------------+------------+--------------+----------------+-----------------+-----------------+-----+</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> 0:MAC        </span>|<span class="string"> 12         </span>|<span class="string"> VARCHAR    </span>|<span class="string"> 12           </span>|<span class="string"> null           </span>|<span class="string"> null            </span>|<span class="string"> null            </span>|<span class="string"> 1   </span>|</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> 0:TIME       </span>|<span class="string"> 3          </span>|<span class="string"> DECIMAL    </span>|<span class="string"> null         </span>|<span class="string"> null           </span>|<span class="string"> null            </span>|<span class="string"> null            </span>|<span class="string"> 1   </span>|</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> :ID          </span>|<span class="string"> 1          </span>|<span class="string"> CHAR       </span>|<span class="string"> 26           </span>|<span class="string"> null           </span>|<span class="string"> null            </span>|<span class="string"> null            </span>|<span class="string"> 0   </span>|</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> 0:CELL       </span>|<span class="string"> 1          </span>|<span class="string"> CHAR       </span>|<span class="string"> 4            </span>|<span class="string"> null           </span>|<span class="string"> null            </span>|<span class="string"> null            </span>|<span class="string"> 1   </span>|</span><br><span class="line">+------------+--------------+-------------+--------------+------------+------------+--------------+----------------+-----------------+-----------------+-----+</span><br></pre></td></tr></table></figure>
<p>注意，Phoenix把原来的TimeStamp类型的时间变成了Decimal，应该是用整数的时间戳来表示时间了，这样运算起来简单！</p>
<p>接下来看一下该表的主键构成<code>!primarykeys bigjoy.mac_idx</code>，结果如下。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------------+--------------+-------------+--------------+----------+----------+--------------+------------+------------+--------------+-+</span><br><span class="line">|<span class="string"> TABLE_CAT  </span>|<span class="string"> TABLE_SCHEM  </span>|<span class="string"> TABLE_NAME  </span>|<span class="string"> COLUMN_NAME  </span>|<span class="string"> KEY_SEQ  </span>|<span class="string"> PK_NAME  </span>|<span class="string"> ASC_OR_DESC  </span>|<span class="string"> DATA_TYPE  </span>|<span class="string"> TYPE_NAME  </span>|<span class="string"> COLUMN_SIZE  </span>|<span class="string"> </span>|</span><br><span class="line">+------------+--------------+-------------+--------------+----------+----------+--------------+------------+------------+--------------+-+</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> 0:MAC        </span>|<span class="string"> 1        </span>|<span class="string">          </span>|<span class="string"> A            </span>|<span class="string"> 12         </span>|<span class="string"> VARCHAR    </span>|<span class="string"> 12           </span>|<span class="string"> </span>|</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> 0:TIME       </span>|<span class="string"> 2        </span>|<span class="string">          </span>|<span class="string"> A            </span>|<span class="string"> 3          </span>|<span class="string"> DECIMAL    </span>|<span class="string"> null         </span>|<span class="string"> </span>|</span><br><span class="line">|<span class="string">            </span>|<span class="string"> BIGJOY       </span>|<span class="string"> MAC_IDX     </span>|<span class="string"> :ID          </span>|<span class="string"> 3        </span>|<span class="string">          </span>|<span class="string"> A            </span>|<span class="string"> 1          </span>|<span class="string"> CHAR       </span>|<span class="string"> 26           </span>|<span class="string"> </span>|</span><br><span class="line">+------------+--------------+-------------+--------------+----------+----------+--------------+------------+------------+--------------+-+</span><br></pre></td></tr></table></figure>
<p>可以看出，该表的主键是由0:MAC,0:TIME,:ID按顺序构成的，不过:ID是什么玩意儿，是原数据表的主键？为了验证猜想，请接着看(｡･ω･)</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:phoenix:localhost&gt; select * from bigjoy.mac<span class="emphasis">_idx limit 1;</span></span><br><span class="line"><span class="emphasis">+---------------+------------------+-----------------------------+---------+</span></span><br><span class="line"><span class="emphasis">|     0:MAC     |      0:TIME      |             :ID             | 0:CELL  |</span></span><br><span class="line"><span class="emphasis">+---------------+------------------+-----------------------------+---------+</span></span><br><span class="line"><span class="emphasis">| 000000000C00  | 1.396363024E+12  | 02281396334224000000000C00  | 228     |</span></span><br><span class="line"><span class="emphasis">+---------------+------------------+-----------------------------+---------+</span></span><br><span class="line"><span class="emphasis">1 row selected (0.123 seconds)</span></span><br></pre></td></tr></table></figure>
<p>这里也可以看出该索引表（是真的能被用户看到的表哈）包含了4个字段，前三个刚才讲了，是构成主键的组成部分，0:CELL很好理解，就是创建索引时include 后边的cell字段了。有:ID了不是，好的，去hbase shell中利用:ID查询一下数据！</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):038:0&gt; get 'BIGJOY.IMOS','02281396334224000000000C00'</span><br><span class="line">COLUMN                                   CELL                                                                                                                 </span><br><span class="line"> 0:CELL                                  timestamp=1470667019714, value=228        </span><br><span class="line"> 0:FLOOR                                 timestamp=1470667019714, value=20010    </span><br><span class="line"> 0:MAC                                   timestamp=1470667019714, value=000000000C00</span><br><span class="line"> 0:TIME                                  timestamp=1470667019714, value=<span class="symbol">\x</span>80<span class="symbol">\x</span>00<span class="symbol">\x</span>01E<span class="symbol">\x</span>1D<span class="symbol">\x</span>B8<span class="symbol">\x</span>D6<span class="symbol">\x</span>80<span class="symbol">\x</span>00<span class="symbol">\x</span>00<span class="symbol">\x</span>00<span class="symbol">\x</span>00</span><br><span class="line"> 0:X                                     timestamp=1470667019714, value=<span class="symbol">\x</span>80<span class="symbol">\x</span>01<span class="symbol">\x</span>85<span class="symbol">\x</span>1D</span><br><span class="line"> 0:Y                                     timestamp=1470667019714, value=<span class="symbol">\x</span>80<span class="symbol">\x</span>01<span class="symbol">\x</span>82<span class="symbol">\x</span>E8</span><br><span class="line"> 0:_0                                    timestamp=1470667019714, value=x                                                                                     </span><br><span class="line">7 row(s) in 0.0260 seconds</span><br></pre></td></tr></table></figure>
<p>嗯，果不其然呀，<strong> :ID在索引表中参与构成主键，首先是保证了索引表主键的唯一性，因此Global Index是密集索引，另外，它对查询也是有帮助的</strong>，埋个伏笔，下面会提到！</p>
<h2 id="4-3-查询计划解读"><a href="#4-3-查询计划解读" class="headerlink" title="4.3 查询计划解读"></a>4.3 查询计划解读</h2><h3 id="4-3-1-Phoenix提供了Explain命令，解释执行计划，下面先看mac约束的对比吧，咣当咣当真是够长的-￣ˇ￣"><a href="#4-3-1-Phoenix提供了Explain命令，解释执行计划，下面先看mac约束的对比吧，咣当咣当真是够长的-￣ˇ￣" class="headerlink" title="4.3.1 Phoenix提供了Explain命令，解释执行计划，下面先看mac约束的对比吧，咣当咣当真是够长的(￣ˇ￣)"></a>4.3.1 Phoenix提供了Explain命令，解释执行计划，下面先看mac约束的对比吧，咣当咣当真是够长的(￣ˇ￣)</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">0: jdbc:phoenix:localhost&gt; explain select cell from bigjoy.imos where mac = <span class="emphasis">'28E14CA61635'</span>;</span><br><span class="line"><span class="code">+-----------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">|                                                   PLAN                                                    |</span><br><span class="line"><span class="code">+-----------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| CLIENT 1-CHUNK 0 ROWS 0 BYTES PARALLEL 1-WAY ROUND ROBIN RANGE SCAN OVER BIGJOY.MAC<span class="emphasis">_IDX ['28E14CA61635']  |</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">1 row selected (0.584 seconds)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">0: jdbc:phoenix:localhost&gt; explain select time from bigjoy.imos where mac = '28E14CA61635';</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">|                                                   PLAN                                                    |</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| CLIENT 1-CHUNK 0 ROWS 0 BYTES PARALLEL 1-WAY ROUND ROBIN RANGE SCAN OVER BIGJOY.MAC_</span>IDX [<span class="emphasis">'28E14CA61635'</span>]  |</span><br><span class="line">|     SERVER FILTER BY FIRST KEY ONLY                                                                       |</span><br><span class="line"><span class="code">+-----------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">2 rows selected (0.038 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:phoenix:localhost&gt; explain select * from bigjoy.imos where mac = <span class="emphasis">'28E14CA61635'</span>;</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">|                                                 PLAN                                                 |</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| CLIENT 6-CHUNK 22526956 ROWS 1258291413 BYTES PARALLEL 1-WAY ROUND ROBIN FULL SCAN OVER BIGJOY.IMOS  |</span><br><span class="line">|     SERVER FILTER BY MAC = <span class="emphasis">'28E14CA61635'</span>                                                            |</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">2 rows selected (0.038 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:phoenix:localhost&gt; explain select * from bigjoy.imos where mac = <span class="emphasis">'28E14CA61635'</span>;</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">|                                                 PLAN                                                 |</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| CLIENT 6-CHUNK 22526956 ROWS 1258291413 BYTES PARALLEL 1-WAY ROUND ROBIN FULL SCAN OVER BIGJOY.IMOS  |</span><br><span class="line">|     SERVER FILTER BY MAC = <span class="emphasis">'28E14CA61635'</span>                                                            |</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">2 rows selected (0.036 seconds)</span><br></pre></td></tr></table></figure>
<p>看到这里就明白了吧，当查询cell字段的时候，是直接去索引表了提取出了cell的值；但当包含了创建索引表时没有提供的字段的时候，Phoenix就是回到原数据表进行全表扫描了，不过是最终在服务器端进行了Filter过滤而已，关于为什么使用了Filter还是进行的全表扫描哦，可以参见<a href="http://dequn.github.io/2016/08/24/right-way-to-use-hbase-rowfilter_and_accelerate_hbase_query/">HBase RowFilter 的使用误区及如何加快 HBase 查询速度</a>！</p>
<h3 id="4-3-2-那么接下来看一下time约束的索引查询计划！"><a href="#4-3-2-那么接下来看一下time约束的索引查询计划！" class="headerlink" title="4.3.2 那么接下来看一下time约束的索引查询计划！"></a>4.3.2 那么接下来看一下time约束的索引查询计划！</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">0: jdbc:phoenix:localhost&gt; explain select cell from bigjoy.imos where time = to<span class="emphasis">_date('2014-04-01 20:39:42.000');</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">|                                          PLAN                                           |</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| CLIENT 4-CHUNK 0 ROWS 0 BYTES PARALLEL 1-WAY ROUND ROBIN FULL SCAN OVER BIGJOY.MAC_</span>IDX  |</span><br><span class="line">|     SERVER FILTER BY TO<span class="emphasis">_TIMESTAMP("TIME") = TIMESTAMP '2014-04-01 20:39:42.000'         |</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">2 rows selected (0.062 seconds)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">0: jdbc:phoenix:localhost&gt; explain select * from bigjoy.imos where time = to_</span>date(<span class="emphasis">'2014-04-01 20:39:42.000'</span>);</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">|                                                 PLAN                                                 |</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| CLIENT 6-CHUNK 22526956 ROWS 1258291413 BYTES PARALLEL 1-WAY ROUND ROBIN FULL SCAN OVER BIGJOY.IMOS  |</span><br><span class="line">|     SERVER FILTER BY TIME = TIMESTAMP <span class="emphasis">'2014-04-01 20:39:42.000'</span>                                      |</span><br><span class="line"><span class="code">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">2 rows selected (0.039 seconds)</span><br></pre></td></tr></table></figure>
<p>可以看出，仅有time约束的时候，不管进行的是cell查询还是包含其他字段的查询，都是进行全表扫描，不过一个是扫描索引表，一个是原数据表罢了！所以效率没有提升</p>
<h3 id="4-3-3-最后，同时进行mac和time约束查询，从时间对比上就可以猜想是进行了索引表的查询，当然，查询目标不能包含创建索引表时未包含的字段-事实也是如此。"><a href="#4-3-3-最后，同时进行mac和time约束查询，从时间对比上就可以猜想是进行了索引表的查询，当然，查询目标不能包含创建索引表时未包含的字段-事实也是如此。" class="headerlink" title="4.3.3 最后，同时进行mac和time约束查询，从时间对比上就可以猜想是进行了索引表的查询，当然，查询目标不能包含创建索引表时未包含的字段,事实也是如此。"></a>4.3.3 最后，同时进行mac和time约束查询，从时间对比上就可以猜想是进行了索引表的查询，当然，查询目标不能包含创建索引表时未包含的字段,事实也是如此。</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">0: jdbc:phoenix:localhost&gt; explain select cell from bigjoy.imos where mac = <span class="emphasis">'28E14CA61635'</span> and time = to<span class="emphasis">_date('2014-04-01 20:39:42.000');</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">|                                                            PLAN                                                             |</span></span><br><span class="line"><span class="emphasis">+-----------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| CLIENT 1-CHUNK 0 ROWS 0 BYTES PARALLEL 1-WAY ROUND ROBIN RANGE SCAN OVER BIGJOY.MAC_</span>IDX [<span class="emphasis">'28E14CA61635'</span>,1,396,384,782,000]  |</span><br><span class="line"><span class="code">+-----------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">1 row selected (0.049 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:phoenix:localhost&gt; explain select * from bigjoy.imos where mac = <span class="emphasis">'28E14CA61635'</span> and time = to<span class="emphasis">_date('2014-04-01 20:39:42.000');</span></span><br><span class="line"><span class="emphasis">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">|                                                 PLAN                                                 |</span></span><br><span class="line"><span class="emphasis">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| CLIENT 6-CHUNK 22526956 ROWS 1258291413 BYTES PARALLEL 1-WAY ROUND ROBIN FULL SCAN OVER BIGJOY.IMOS  |</span></span><br><span class="line"><span class="emphasis">|     SERVER FILTER BY (MAC = '28E14CA61635' AND TIME = TIMESTAMP '2014-04-01 20:39:42.000')           |</span></span><br><span class="line"><span class="emphasis">+------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">2 rows selected (0.034 seconds)</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3-4-还有，看一下官方给出的Index-Hint方法，可以看出，-ID参与索引表的构成，也是为了实现这一个目的，先查索引表，在根据ID查原表！"><a href="#4-3-4-还有，看一下官方给出的Index-Hint方法，可以看出，-ID参与索引表的构成，也是为了实现这一个目的，先查索引表，在根据ID查原表！" class="headerlink" title="4.3.4 还有，看一下官方给出的Index Hint方法，可以看出，:ID参与索引表的构成，也是为了实现这一个目的，先查索引表，在根据ID查原表！"></a>4.3.4 还有，看一下官方给出的<a href="https://phoenix.apache.org/secondary_indexing.html" target="_blank" rel="noopener">Index Hint</a>方法，可以看出，:ID参与索引表的构成，也是为了实现这一个目的，先查索引表，在根据ID查原表！</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:phoenix:localhost&gt; explain select /<span class="strong">*+ INDEX(bigjoy.imos mac_idx) *</span>/ * from bigjoy.imos where mac = <span class="emphasis">'28E14CA61635'</span>;</span><br><span class="line"><span class="code">+-------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">|                                                       PLAN                                                        |</span><br><span class="line"><span class="code">+-------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| CLIENT 6-CHUNK 22526956 ROWS 1258291413 BYTES PARALLEL 1-WAY ROUND ROBIN FULL SCAN OVER BIGJOY.IMOS               |</span><br><span class="line">|     SKIP-SCAN-JOIN TABLE 0                                                                                        |</span><br><span class="line">|         CLIENT 1-CHUNK 0 ROWS 0 BYTES PARALLEL 1-WAY ROUND ROBIN RANGE SCAN OVER BIGJOY.MAC<span class="emphasis">_IDX ['28E14CA61635']  |</span></span><br><span class="line"><span class="emphasis">|             SERVER FILTER BY FIRST KEY ONLY                                                                       |</span></span><br><span class="line"><span class="emphasis">|     DYNAMIC SERVER FILTER BY "BIGJOY.IMOS.ID" IN ($25.$27)                                                        |</span></span><br><span class="line"><span class="emphasis">+-------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">5 rows selected (0.041 seconds)</span></span><br></pre></td></tr></table></figure>
<h2 id="4-4-什么时候索引发挥作用，什么时候索引不发挥作用（都是指全局索引）？"><a href="#4-4-什么时候索引发挥作用，什么时候索引不发挥作用（都是指全局索引）？" class="headerlink" title="4.4 什么时候索引发挥作用，什么时候索引不发挥作用（都是指全局索引）？"></a>4.4 什么时候索引发挥作用，什么时候索引不发挥作用（都是指全局索引）？</h2><p>通过以上几个例子对比和查询计划分析，并且结合索引表的主键构成(谁让HBase有且只有主键的字典序索引呢)，查询字段只包括创建索引时的字段并且约束条件中包括<strong>构成索引表主键的第一个字段</strong>时，索引表时发挥作用的，其他情况下全局索引不能加快查询速度，这也和官方文档给出的解释是一样样的！</p>
<p>文中使用的例子只包括两个字段约束，如果有三个字段呢,结果又如何？如：(field1, field2, field3)，可以猜想使用field1, field1 + field2, field1 + field3, field1 + field2 + field3进行约束查询，该索引表才会发挥作用！感兴趣的可以去尝试一下！</p>
<p>为什么是这样？还是因为HBase只有字典序的主键索引啊，如果不使用field1进行约束，那么将不能确定索引表中行健的扫描范围，所以仍然要进行全局扫描（索引表或者原数据表），同理，如果查询结果一下，使用field1 + field2 约束理论上是要优于 field1 + field3的，不过既然查询结果都一样了，那么field2 和 field3应该是没有约束作用的，除非field3 == field3。感兴趣的也可以尝试一下！</p>
<h1 id="5总结"><a href="#5总结" class="headerlink" title="5总结"></a>5总结</h1><ul>
<li>Global Index 是密集索引；</li>
<li>要想索引发挥作用，必须包含创建索引是的第一个字段进行约束；</li>
<li>索引字段从前到后，约束越多，查询效率越高（中间不能跳过索引字段），这样可以快速缩小扫描范围；</li>
<li>查询一定不能有索引字段之外的其他字段，不然得去扫描原表；</li>
<li>不满足上一条结论的要求时，官方文档提供的<a href="https://phoenix.apache.org/secondary_indexing.html" target="_blank" rel="noopener">Index Hint</a>方法，是根据索引表得到原表主键，再去原表中根据主键查询其他字段！</li>
</ul>
<p>Local Index 就留着下一次写吧！</p>
</div><div class="tags"><a href="/tags/HBase/">HBase</a><a href="/tags/Secondary-Index/">Secondary Index</a><a href="/tags/Phoenix/">Phoenix</a><a href="/tags/Global-Index/">Global Index</a></div><div class="post-nav"><a href="/2016/09/02/Phoenix-Secondary-Index-Exploration-Local-Index/" class="pre">Phoenix Secondary Index初探之Local Index</a><a href="/2016/08/29/HBase-Secondary-Index-Theory/" class="next">HBase 二级索引实现原理</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'dequn-blog';
var disqus_identifier = '2016/08/29/Phoenix-Secondary-Index-Exploration-Global-Index/';
var disqus_title = 'Phoenix Secondary Index初探之Global Index';
var disqus_url = 'http://dequn.github.io/2016/08/29/Phoenix-Secondary-Index-Exploration-Global-Index/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/next/config.json',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//dequn-blog.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://dequn.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Angular/">Angular</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HBase/">HBase</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Others/">Others</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Phoenix/">Phoenix</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spark/">Spark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Twisted/">Twisted</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zeppelin/">Zeppelin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人日记/">个人日记</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Charles/" style="font-size: 15px;">Charles</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/HBase/" style="font-size: 15px;">HBase</a> <a href="/tags/Secondary-Index/" style="font-size: 15px;">Secondary Index</a> <a href="/tags/hindex/" style="font-size: 15px;">hindex</a> <a href="/tags/ShadowsocksX-NG/" style="font-size: 15px;">ShadowsocksX-NG</a> <a href="/tags/kcptun/" style="font-size: 15px;">kcptun</a> <a href="/tags/Angular/" style="font-size: 15px;">Angular</a> <a href="/tags/filter/" style="font-size: 15px;">filter</a> <a href="/tags/Controller/" style="font-size: 15px;">Controller</a> <a href="/tags/select-cascding/" style="font-size: 15px;">select-cascding</a> <a href="/tags/ui-router/" style="font-size: 15px;">ui-router</a> <a href="/tags/Twisted/" style="font-size: 15px;">Twisted</a> <a href="/tags/d3/" style="font-size: 15px;">d3</a> <a href="/tags/Django/" style="font-size: 15px;">Django</a> <a href="/tags/Celery/" style="font-size: 15px;">Celery</a> <a href="/tags/allauth/" style="font-size: 15px;">allauth</a> <a href="/tags/微信/" style="font-size: 15px;">微信</a> <a href="/tags/Channels/" style="font-size: 15px;">Channels</a> <a href="/tags/WebSocket/" style="font-size: 15px;">WebSocket</a> <a href="/tags/IOT/" style="font-size: 15px;">IOT</a> <a href="/tags/I18N/" style="font-size: 15px;">I18N</a> <a href="/tags/L10N/" style="font-size: 15px;">L10N</a> <a href="/tags/APScheduler/" style="font-size: 15px;">APScheduler</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/Docker-Compose/" style="font-size: 15px;">Docker Compose</a> <a href="/tags/network/" style="font-size: 15px;">network</a> <a href="/tags/DRF/" style="font-size: 15px;">DRF</a> <a href="/tags/foreign-key/" style="font-size: 15px;">foreign key</a> <a href="/tags/Endpoint/" style="font-size: 15px;">Endpoint</a> <a href="/tags/Zookeeper/" style="font-size: 15px;">Zookeeper</a> <a href="/tags/Shadowsocks/" style="font-size: 15px;">Shadowsocks</a> <a href="/tags/elasticsearch/" style="font-size: 15px;">elasticsearch</a> <a href="/tags/Oracle/" style="font-size: 15px;">Oracle</a> <a href="/tags/CentOS/" style="font-size: 15px;">CentOS</a> <a href="/tags/面试/" style="font-size: 15px;">面试</a> <a href="/tags/Hadoop/" style="font-size: 15px;">Hadoop</a> <a href="/tags/MapReduce/" style="font-size: 15px;">MapReduce</a> <a href="/tags/VIM/" style="font-size: 15px;">VIM</a> <a href="/tags/MacVim/" style="font-size: 15px;">MacVim</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/args/" style="font-size: 15px;">args</a> <a href="/tags/spark/" style="font-size: 15px;">spark</a> <a href="/tags/Phoenix/" style="font-size: 15px;">Phoenix</a> <a href="/tags/pyenv/" style="font-size: 15px;">pyenv</a> <a href="/tags/格式化/" style="font-size: 15px;">格式化</a> <a href="/tags/Python3/" style="font-size: 15px;">Python3</a> <a href="/tags/Interceptor/" style="font-size: 15px;">Interceptor</a> <a href="/tags/RowFilter/" style="font-size: 15px;">RowFilter</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Encoding/" style="font-size: 15px;">Encoding</a> <a href="/tags/import/" style="font-size: 15px;">import</a> <a href="/tags/IDE/" style="font-size: 15px;">IDE</a> <a href="/tags/PyCharm/" style="font-size: 15px;">PyCharm</a> <a href="/tags/职业选择/" style="font-size: 15px;">职业选择</a> <a href="/tags/工作与初心/" style="font-size: 15px;">工作与初心</a> <a href="/tags/Local-Index/" style="font-size: 15px;">Local Index</a> <a href="/tags/charset/" style="font-size: 15px;">charset</a> <a href="/tags/encode/" style="font-size: 15px;">encode</a> <a href="/tags/Spark/" style="font-size: 15px;">Spark</a> <a href="/tags/Intellij-IDEA/" style="font-size: 15px;">Intellij IDEA</a> <a href="/tags/Zeppelin/" style="font-size: 15px;">Zeppelin</a> <a href="/tags/Global-Index/" style="font-size: 15px;">Global Index</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/01/17/drf-datetime-timestamp-serializer/">DRF DateTime转换为时间戳</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/13/how-to-resolve-confilcts-between-charles-and-shadowsocks/">Charles和 Shadowsocks 共存设置说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/07/django-i18n-l10n/">Django 国际化和本地化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/23/drf-serializer-foreignkey-post-id-get-full-content/">DRF serializer中外键post使用id，get获取详细信息</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/03/yi-ci-ke-pa-de-wu-cao-zuo/">一次可怕的误操作-暨IDE的重要性</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/14/django-add-user-celery-task/">Django添加用户Celery任务</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/22/communication-between-twisted-services/">Twisted 服务间通信</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/30/docker-network/">记一次Confluence迁移数据库和Docker network网络修改</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/23/docker-compose-subdirectory-dockerfile/">docker-compose 子目录编译、运行</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/21/ShadowsocksX-NG-kcptun-settings/">ShadowsocksX-NG kcptun加速配置释疑</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//dequn-blog.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">dequn's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>